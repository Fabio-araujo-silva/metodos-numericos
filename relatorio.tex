\documentclass{article} % change to article if necessary 
\usepackage[brazilian]{babel}
\usepackage{graphicx, txfonts} % Required for inserting images
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm} \usepackage{mathtools} \usepackage{lmodern} \usepackage{tikz}
\usepackage{cancel}
\usepackage{booktabs}
\usepackage{tabularx}
\usepackage[shortlabels]{enumitem}
\newcommand\myalign[1]{\centerline{$\displaystyle#1$}}
\usepackage{tcolorbox} \tcbuselibrary{theorems}
\newcommand{\heart}
{\ensuremath\heartsuit}
\newcommand{\mdc}{\mathrm{mdc}}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\rot}{rot}
\DeclareMathOperator{\gr}{Gr}
\DeclareMathOperator{\tr}{tr}
\newcommand{\filledheart}{\ensuremath\varheartsuit}

\title{Relatório – Solução de Sistemas Lineares Aplicados a Grafos de Manhattan}
\author
{
  Vinícius Girão de Castro | 15491730 \\
  Natália Carvalho | 15497232 \\
  Larissa |  \\
  Fábio Araujo | 16311045 \\
}
\date{}

\pdfsuppresswarningpagegroup=1

%\newtheorem{theorem}{Teorema}[section]
%\newtheorem{prop}{Proposição}[theorem]
\newtheorem{definition}{Definição}[section]
\newtheorem{exer}{}[section]
\newtheorem{prop}{Proposição}[section]
\newtheorem{cor}{Corolário}[prop]
\newtheorem{exemplo}{Exemplo}[section]
\newtheorem{resultado}{Resultado}[section]
\newtcbtheorem[number within=section]{theorem}{Teorema}%
{colback=red!5,colframe=red!35!black,fonttitle=\bfseries}{th}
\newtcbtheorem[number within=section]{propp}{Proposição}%
{colback=green!5,colframe=green!35!black,fonttitle=\bfseries}{pr}
\newtcbtheorem[number within=section]{lema}{Lema}%
{colback=yellow!5,colframe=yellow!35!black,fonttitle=\bfseries}{lm}

\theoremstyle{definition}
\newenvironment{dem}{\paragraph{\textit{Dem.:}}}{\hfill$\square$}

\begin{document}
\maketitle
    \section*{Objetivo}
        Este trabalho tem como objetivo resolver um sistema linear oriundo de um grafo de ruas da 
        ilha de Manhattan, utilizando diferentes métodos numéricos: LU, Cholesky,
        Jacobi, Gauss-Seidel e Gradientes Conjugados; e comparar o desempenho de cada um.
    \section*{Descrição do problema}
        Utilizando os arquivos manh.el (arestas) e manh.xy (coordenadas dos vértices),
        foi construído um grafo representando o sistema de ruas de Manhattan.
        As etapas seguidas foram:
        \begin{itemize}
            \item Seleção da maior componente conexa do grafo;
            \item escolha de $k$ vértices aleatórios $v_{i1}, v_{i2}, \ldots, v_{ik}$ e atribuição
                de valores $c_{i1}, c_{i2}, \ldots, c_{ik} \in (0, 10];$
            \item construção da matriz Laplaciana $L$ do grafo;
            \item Construção da matriz de penalidades  $P = \left(P_{ij}\right) $, onde  
                $$P_{ij} =
                \begin{cases}
                    \alpha = 1.0e7, \text{ se $j$ é um índice de um vértice escolhido} \\
                    0, \text{ caso contrário;}
                \end{cases}$$
            \item construção do vetor $b = \left( b_j \right)$, onde
                $$b_j= 
                \begin{cases}
                    c_{i_s}, \text{ se } $j=i_s$ \\
                    0, \text{ caso contrário;}
                \end{cases}$$
            \item resolução do sistema $\left(L+P \right)x=Pb$.
         \end{itemize}
    \section*{Métodos utilizados}
        \subsection*{Decomposição LU}
            \begin{itemize}
                \item A matriz $A = L + P$ foi decomposta em  $A = LU$;
                \item Resolvido em duas etapas:
                    \begin{enumerate}[a)]
                        \item $Ly = Pb$
                        \item  $Ux = y$;
                    \end{enumerate}
                \item vantagem: aplicável à qualquer matriz não singular;
                \item desvantagem: alto custo para matrizes esparsas.
            \end{itemize}
            \subsection*{Decomposição de Cholesky}
            
                O método iterativo estrutura-se com a decomposição $A = HH^T$, sendo $H$ triangular
                inferior.
                Então é calculada a solução em duas etapas:
                \begin{enumerate}[a)]
                    \item $Hy = Pb$
                    \item $H^Tx = y$.
                \end{enumerate}
                Para que possamos determinar $H$, é necessário que a matriz $A$ seja simétrica
                definida positiva.

                Sabe-se que toda matriz Laplaciana de um grafo conexo é necessariamente simétrica 
                semidefinida
                positiva, mas ao adicionar a matriz de penalidades, com valores grandes e positivos 
                na diagonal,
                algumas posições da solução são fortemente forçadas a assumir os valores desejados
                definidos em b.
                Esses grandes valores diagonais empurram todos os autovalores da matriz para cima,
                garantindo
                que todos sejam estritamente positivos.

                Em conclusão, a matriz A torna-se simétrica definida positiva
                (SPD), o que justifica o uso seguro da Decomposição de Cholesky.
                Tal método tem como vantagem ser mais eficiente que LU, apesar de requerer que a 
                matriz seja SPD.
                Para o teste com 400 valores, o método levou $306.722567$ segundos, ou seja, 
                pouco mais de 5 minutos.


        \subsection*{Método de Jacobi}
            \begin{itemize}
                \item Iterativo, baseado em $A = D + R$;
                \item iteração:  $x^{k+1} = D^{-1} \left( Pb - Rx^k \right) $ ;
                \item vantagem: simples e paralelizável;
                \item desvantagem: convergência lenta.
            \end{itemize}
        \subsection*{Gauss-Seidel}
            \begin{itemize}
                \item Iterativo - usa atualizações imediatas;
                \item iteração: $(x_i)^{k+1} = \left( 1/A_{ii} \right)
                    \left( Pb_i - \text{ somas envolvendo } x^{k+1} \text{ e } x^k \right) $;
                \item vantagem: converge mais rápido que Jacobi;
                \item desvantagem: menos paralelizável.
            \end{itemize}

        \subsection*{Gradientes conjugados (CG)}

            \begin{itemize}
                \item Iterativo para matrizes SPD;
                \item minimiza $f\left( x \right) = 0.5x^T Ax - x^T Pb$;
                \item atualiza $x$ em direções ortogonais;
                \item vantagem: eficiente para matrizes grandes esparsas;
                \item desvantagem: depende do condicionamento.
            \end{itemize}

        \subsection*{Comparativo dos métodos}
                \begin{table}[h!]
                \centering
                \caption{Comparação dos métodos}
                \renewcommand{\arraystretch}{1.3} % Aumenta o espaçamento entre linhas
                \begin{tabularx}{\textwidth}{@{}lXXXXX@{}} % 1 coluna fixa + 5 expansíveis
                \toprule
                Método         & LU      & Cholesky & Jacobi    & Gauss-Seidel & CG \\
                \midrule
                Tipo           & Direto  & Direto   & Iterativo & Iterativo    & Iterativo \\
                Requisitos     & Matriz não singular 
                               & Matriz SPD 
                               & Preferível diagonal dominante 
                               & Igual ao Jacobi 
                               & Matriz SPD \\
                Observações    & Alto custo de memória 
                               & Mais eficiente que LU 
                               & Convergência lenta 
                               & Convergência mais rápida 
                               & Melhor desempenho geral \\
                \bottomrule
                \end{tabularx}
                \end{table}
        \subsection*{Conclusão}

            Todos os métodos foram capazes de resolver o sistema. 
            Os métodos diretos (LU e Cholesky) forneceram soluções exatas rapidamente,
            com destaque para o Cholesky, que foi mais eficiente devido à estrutura da matriz.

            Entre os iterativos, os Gradientes Conjugados apresentaram o melhor desempenho para
            o caso estudado, sendo uma excelente opção para problemas de grande escala com
            matrizes esparsas e SPD.
            \end{document}
